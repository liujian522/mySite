(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-da1140f0"],{"23b0":function(t,e,a){"use strict";e["a"]=function(t){return{mounted(){this.$refs[t].addEventListener("scroll",this.handleScrollMiXins),this.$Bus.$on("setScroll",this.setScrollMiXins)},destroyed(){this.$Bus.$emit("scroll"),this.$Bus.$emit("del"),this.$Bus.$off("setScroll",this.setScrollMiXins)},methods:{setScrollMiXins(e){this.$refs[t].scrollTop=e},handleScrollMiXins(){this.$Bus.$emit("scroll",this.$refs[t])}}}}},"272c":function(t,e,a){},2828:function(t,e,a){"use strict";a("c3e6")},5028:function(t,e,a){},"81c6":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"blogComment-container"},[a("InputBox",t._g({},t.$listeners)),a("Comment",{attrs:{title:t.title,subTitle:t.subTitle,list:t.list}}),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticClass:"loading"},[t._v(t._s(t.isMore?"没有更多数据":""))])],1)},i=[],n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("form",{ref:"form",staticClass:"inputBox-container",attrs:{id:"data-form-container"},on:{submit:function(e){return e.preventDefault(),t.handleSubmit.apply(null,arguments)}}},[a("div",{staticClass:"divInput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.nickName,expression:"formData.nickName"}],staticClass:"nickName",attrs:{type:"text",placeholder:"用户昵称",maxlength:"10"},domProps:{value:t.formData.nickName},on:{input:function(e){e.target.composing||t.$set(t.formData,"nickName",e.target.value)}}}),a("span",{staticClass:"example"},[t._v(t._s(t.formData.nickName.length)+"/10")]),a("p",{staticClass:"nickNameHint"},[t._v(t._s(t.error.nickName))])]),a("div",{staticClass:"commentBox"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.formData.content,expression:"formData.content"}],staticClass:"comment",attrs:{cols:"",rows:"",type:"text",placeholder:"请输入内容",maxlength:"300"},domProps:{value:t.formData.content},on:{input:function(e){e.target.composing||t.$set(t.formData,"content",e.target.value)}}}),a("p",{staticClass:"commentHint"},[t._v(t._s(t.error.content))])]),a("button",{staticClass:"submit",attrs:{type:"submit",disabled:t.isSubmiting}},[t._v(" "+t._s(t.isSubmiting?"提交...":"提交")+" ")])])},r=[],o={data(){return{formData:{nickName:"",content:""},error:{nickName:"",content:""},isSubmiting:!1}},computed:{},methods:{handleSubmit(){this.formData.nickName?this.error.nickName="":this.error.nickName="请填写昵称",this.formData.content?this.error.content="":this.error.content="请填写内容",this.error.nickName||this.error.content||(this.isSubmiting=!0,this.$emit("submit",this.formData,t=>{showMessage({content:t,type:"ok",container:this.$refs.form,callBack:()=>{this.isSubmiting=!1,this.formData.nickName="",this.formData.content=""}})}))}}},c=o,l=(a("df9b"),a("2877")),u=Object(l["a"])(c,n,r,!1,null,"ea02ed32",null),m=u.exports,d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"comment-container"},[a("h4",[t._v(t._s(t.title)+"("+t._s(t.subTitle)+")")]),a("div",{staticClass:"comment"},[a("ul",t._l(t.list,(function(e,s){return a("li",{key:s},[a("div",[a("Avatar",{attrs:{url:e.avatar,size:44}}),a("div",[a("h6",[t._v(t._s(e.nickname))]),a("span",[t._v(t._s(t.formatDate(e.createDate,!0)))]),a("p",[t._v(" "+t._s(e.content)+" ")])])],1),a("hr")])})),0)])])},f=[],h=a("fd5a"),p=a("ed08"),g={components:{Avatar:h["a"]},methods:{formatDate(t,e){return Object(p["b"])(t,e)}},props:{title:{type:String,default:""},subTitle:{type:String,default:""},list:{type:Array,default:[]}},created(){},updated(){}},v=g,b=(a("2828"),Object(l["a"])(v,d,f,!1,null,"303af646",null)),_=b.exports,w={components:{InputBox:m,Comment:_},data(){return{}},props:{isMore:{type:Boolean,default:!1,required:!0},title:{type:String,default:""},subTitle:{type:String,default:""},list:{type:Array,default:[]},listLoading:{type:Boolean,default:!1}},methods:{}},$=w,D=(a("9f9a"),Object(l["a"])($,s,i,!1,null,"7c6c8ba4",null));e["a"]=D.exports},"8fc4":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"container",staticClass:"message-container"},[a("BlogComment",{attrs:{isMore:t.isMore,title:"留言板",subTitle:t.data.total+"",list:t.data.rows,listLoading:t.isLoading},on:{submit:t.handleSubmit}})],1)},i=[],n=a("81c6"),r=a("f52e");async function o(t){return await r["a"].post("/api/message",t)}async function c(t=1,e=10,a=""){return await r["a"].get("/api/message","get",{params:{page:t,limit:e,keyword:a}})}var l=a("f688"),u=a("23b0"),m={mixins:[Object(l["a"])([]),Object(u["a"])("container")],components:{BlogComment:n["a"]},methods:{async handleSubmit(t,e){let a=await o({...t});this.data.rows.unshift(a),this.data.total++,e("留言成功")},async feachData(){return await c()},async handleScrollMiXins(){if(this.$Bus.$emit("scroll",this.$refs.container),this.isLoading)return;const t=this.$refs.container.clientHeight,e=this.$refs.container.scrollTop,a=this.$refs.container.scrollHeight;a-(t+e)<80&&await this.getMoreComments()},async getMoreComments(){if(this.isMore)return;this.page++,this.isLoading=!0;const t=await c(this.page,this.limit);this.data.total=t.total,this.data.rows=this.data.rows.concat(t.rows),this.sortData(),this.isLoading=!1}},data(){return{data:{rows:[],total:"0"},page:1,limit:10}},computed:{isMore(){return this.data.rows.length>=this.data.total}}},d=m,f=(a("e0cd"),a("2877")),h=Object(f["a"])(d,s,i,!1,null,"f1e93648",null);e["default"]=h.exports},"9f9a":function(t,e,a){"use strict";a("272c")},c3e6:function(t,e,a){},df9b:function(t,e,a){"use strict";a("e970")},e0cd:function(t,e,a){"use strict";a("5028")},e970:function(t,e,a){},f688:function(t,e,a){"use strict";e["a"]=function(t=null){return{data(){return{data:t,isLoading:!0}},async created(){this.data=await this.feachData(),this.sortData(),this.isLoading=!1},methods:{sortData(){this.data.rows&&this.data.rows.sort((t,e)=>e.createDate-t.createDate)}}}}}}]);
//# sourceMappingURL=chunk-da1140f0.bdbd70e3.js.map