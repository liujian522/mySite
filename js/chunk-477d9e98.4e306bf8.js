(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-477d9e98"],{1378:function(t,e,i){"use strict";i("87f7")},"23b0":function(t,e,i){"use strict";e["a"]=function(t){return{mounted(){this.$refs[t].addEventListener("scroll",this.handleScrollMiXins),this.$Bus.$on("setScroll",this.setScrollMiXins)},destroyed(){this.$Bus.$emit("scroll"),this.$Bus.$emit("del"),this.$Bus.$off("setScroll",this.setScrollMiXins)},methods:{setScrollMiXins(e){this.$refs[t].scrollTop=e},handleScrollMiXins(){this.$Bus.$emit("scroll",this.$refs[t])}}}}},"272c":function(t,e,i){},2828:function(t,e,i){"use strict";i("c3e6")},"2c43":function(t,e,i){},"3aa6":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ul",{staticClass:"list-container"},t._l(t.getSelectList,(function(e,a){return i("li",{key:a},[i("span",{class:{active:e.isActive},on:{click:function(i){return t.handClick(e)}}},[t._v(" "+t._s(e.name)+" "),e.articleCount?i("span",{staticClass:"articleCount"},[t._v(t._s(e.articleCount)+"篇")]):t._e()]),i("List",{attrs:{list:e.children},on:{select:t.handClick}})],1)})),0)},s=[],n=i("ed08"),o={name:"List",data(){return{activeAnchor:""}},props:{list:{type:Array,default:()=>[]}},methods:{handClick(t){this.$emit("select",t)},setSelect(t){if(!t)return;this.activeAnchor="";const e=200;for(const i of this.getDom){if(!i)continue;const t=i.getBoundingClientRect().top;if(!(t<e))return;this.activeAnchor=i.id}}},mounted(){this.setDebounce=Object(n["a"])(this.setSelect,300),this.$Bus.$on("scroll",this.setDebounce)},destroyed(){this.$Bus.$off("scroll",this.setDebounce)},computed:{getSelectList(){const t=(e=[])=>e.map(e=>({...e,isActive:"boolean"===typeof e.isActive?e.isActive:e.anchor===this.activeAnchor,children:t(e.children)}));return t(this.list)},getDom(){const t=[],e=i=>{for(const a of i)t.push(document.getElementById(a.anchor)),a.children&&a.children.length&&e(a.children);return t};return e(this.getSelectList),t}}},r=o,c=(i("e49a"),i("2877")),l=Object(c["a"])(r,a,s,!1,null,"5e54d3d4",null);e["a"]=l.exports},"81c6":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"blogComment-container"},[i("InputBox",t._g({},t.$listeners)),i("Comment",{attrs:{title:t.title,subTitle:t.subTitle,list:t.list}}),i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticClass:"loading"},[t._v(t._s(t.isMore?"没有更多数据":""))])],1)},s=[],n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("form",{ref:"form",staticClass:"inputBox-container",attrs:{id:"data-form-container"},on:{submit:function(e){return e.preventDefault(),t.handleSubmit.apply(null,arguments)}}},[i("div",{staticClass:"divInput"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.nickName,expression:"formData.nickName"}],staticClass:"nickName",attrs:{type:"text",placeholder:"用户昵称",maxlength:"10"},domProps:{value:t.formData.nickName},on:{input:function(e){e.target.composing||t.$set(t.formData,"nickName",e.target.value)}}}),i("span",{staticClass:"example"},[t._v(t._s(t.formData.nickName.length)+"/10")]),i("p",{staticClass:"nickNameHint"},[t._v(t._s(t.error.nickName))])]),i("div",{staticClass:"commentBox"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.formData.content,expression:"formData.content"}],staticClass:"comment",attrs:{cols:"",rows:"",type:"text",placeholder:"请输入内容",maxlength:"300"},domProps:{value:t.formData.content},on:{input:function(e){e.target.composing||t.$set(t.formData,"content",e.target.value)}}}),i("p",{staticClass:"commentHint"},[t._v(t._s(t.error.content))])]),i("button",{staticClass:"submit",attrs:{type:"submit",disabled:t.isSubmiting}},[t._v(" "+t._s(t.isSubmiting?"提交...":"提交")+" ")])])},o=[],r={data(){return{formData:{nickName:"",content:""},error:{nickName:"",content:""},isSubmiting:!1}},computed:{},methods:{handleSubmit(){this.formData.nickName?this.error.nickName="":this.error.nickName="请填写昵称",this.formData.content?this.error.content="":this.error.content="请填写内容",this.error.nickName||this.error.content||(this.isSubmiting=!0,this.$emit("submit",this.formData,t=>{showMessage({content:t,type:"ok",container:this.$refs.form,callBack:()=>{this.isSubmiting=!1,this.formData.nickName="",this.formData.content=""}})}))}}},c=r,l=(i("df9b"),i("2877")),u=Object(l["a"])(c,n,o,!1,null,"ea02ed32",null),d=u.exports,m=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"comment-container"},[i("h4",[t._v(t._s(t.title)+"("+t._s(t.subTitle)+")")]),i("div",{staticClass:"comment"},[i("ul",t._l(t.list,(function(e,a){return i("li",{key:a},[i("div",[i("Avatar",{attrs:{url:e.avatar,size:44}}),i("div",[i("h6",[t._v(t._s(e.nickname))]),i("span",[t._v(t._s(t.formatDate(e.createDate,!0)))]),i("p",[t._v(" "+t._s(e.content)+" ")])])],1),i("hr")])})),0)])])},h=[],f=i("fd5a"),p=i("ed08"),g={components:{Avatar:f["a"]},methods:{formatDate(t,e){return Object(p["b"])(t,e)}},props:{title:{type:String,default:""},subTitle:{type:String,default:""},list:{type:Array,default:[]}},created(){},updated(){}},v=g,b=(i("2828"),Object(l["a"])(v,m,h,!1,null,"303af646",null)),_=b.exports,D={components:{InputBox:d,Comment:_},data(){return{}},props:{isMore:{type:Boolean,default:!1,required:!0},title:{type:String,default:""},subTitle:{type:String,default:""},list:{type:Array,default:[]},listLoading:{type:Boolean,default:!1}},methods:{}},y=D,L=(i("9f9a"),Object(l["a"])(y,a,s,!1,null,"7c6c8ba4",null));e["a"]=L.exports},"864d":function(t,e,i){"use strict";i.d(e,"c",(function(){return s})),i.d(e,"b",(function(){return n})),i.d(e,"a",(function(){return o})),i.d(e,"e",(function(){return r})),i.d(e,"d",(function(){return c}));var a=i("f52e");async function s(t=1,e=10,i=-1){return await a["a"].get("/api/blogs",{params:{page:t,limit:e,categoryid:i}})}async function n(){return await a["a"].get("/api/blogtypes")}async function o(t){return await a["a"].get("/api/blog/"+t)}async function r(t){return await a["a"].post("/api/comment",t)}async function c(t=-1,e=1,i=10){return await a["a"].get("/api/comment",{params:{page:e,limit:i,blogid:t}})}},"87f7":function(t,e,i){},"9f9a":function(t,e,i){"use strict";i("272c")},ad4c:function(t,e,i){"use strict";i("e92e")},b7a5:function(t,e,i){"use strict";i("d38d")},c3e6:function(t,e,i){},d38d:function(t,e,i){},d56c:function(t,e,i){},db6a:function(t,e,i){},df9b:function(t,e,i){"use strict";i("e970")},e49a:function(t,e,i){"use strict";i("d56c")},e92e:function(t,e,i){},e970:function(t,e,i){},ea40:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"details-container"},[i("Layout",{scopedSlots:t._u([{key:"right",fn:function(){return[i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticClass:"right-container"},[t.isLoading?t._e():i("Doc",{attrs:{list:t.data.toc}})],1)]},proxy:!0}])},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],ref:"container",staticClass:"auto-container"},[t.isLoading?t._e():i("BlogContent",{attrs:{content:t.data}}),t.isLoading?t._e():i("BlogComment",{attrs:{title:"评论列表",subTitle:""+t.listData.total,listLoading:t.listLoading,list:t.listData.rows||[],isMore:t.isMore},on:{submit:t.handleSubmit}})],1)])],1)},s=[],n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"doc-container"},[i("h3",[t._v("目录")]),i("List",{attrs:{list:t.list},on:{select:t.handSelect}})],1)},o=[],r=i("3aa6"),c={components:{List:r["a"]},props:{list:{type:Array}},methods:{handSelect(t){location.hash=t.anchor}}},l=c,u=(i("b7a5"),i("2877")),d=Object(u["a"])(l,n,o,!1,null,"626d5da0",null),m=d.exports,h=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"blogContent-container"},[i("h1",[t._v(t._s(t.content.title))]),i("div",{staticClass:"qita"},[i("span",[t._v(" 日期:"+t._s(t.formatDate(t.content.createDate)))]),i("span",[t._v(" 浏览:"+t._s(t.content.scanNumber))]),i("a",{attrs:{href:"#data-form-container"}},[t._v(" 评论:"+t._s(t.content.commentNumber))]),i("RouterLink",{attrs:{to:{name:"CategoryBlog",params:{categoryId:t.content.category.name}}}},[t._v(t._s(t.content.category.name))])],1),i("div",{staticClass:"markdown-body",domProps:{innerHTML:t._s(t.content.htmlContent)}})])},f=[],p=(i("db6a"),i("2c43"),i("ed08")),g={data(){return{}},props:{content:{type:Object,required:!0}},methods:{formatDate(t){return Object(p["b"])(t)}}},v=g,b=(i("1378"),Object(u["a"])(v,h,f,!1,null,"0ff3ef2a",null)),_=b.exports,D=i("5849"),y=i("864d"),L=i("f688"),C=i("81c6"),$=i("23b0"),w={data(){return{listLoading:!1,listData:{total:0,rows:[]}}},components:{Layout:D["a"],Doc:m,BlogContent:_,BlogComment:C["a"]},mixins:[Object(L["a"])({}),Object($["a"])("container")],computed:{idPageLimit(){return{detailsId:this.$route.params.detailId,page:1,limit:10}},isMore(){return this.listData.rows.length>=this.listData.total}},methods:{async feachData(){return await Object(y["a"])(this.$route.params.detailId)},async getMoreComments(){if(this.isMore)return;this.idPageLimit.page++,this.listLoading=!0;const t=await Object(y["d"])(this.idPageLimit.detailId,this.idPageLimit.page,this.idPageLimit.limit);this.listData.total=t.total,this.listData.rows=this.listData.rows.concat(t.rows),this.sortListData(),this.listLoading=!1},sortListData(){console.log(this.listData),this.listData.rows.sort((t,e)=>e.createDate-t.createDate)},async handleSubmit(t,e){let i=await Object(y["e"])({blogId:this.idPageLimit.detailsId,...t});this.listData.rows.unshift(i),this.listData.total++,e("评论成功")},async handleScrollMiXins(){if(this.$Bus.$emit("scroll",this.$refs.container),this.listLoading)return;const t=this.$refs.container.clientHeight,e=this.$refs.container.scrollTop,i=this.$refs.container.scrollHeight;i-(t+e)<80&&await this.getMoreComments()}},async created(){this.listData=await Object(y["d"])(this.idPageLimit.detailId,this.idPageLimit.page,this.idPageLimit.limit),this.sortListData()},mounted(){const t=location.hash;location.hash="",setTimeout(()=>{location.hash=t},1e3)}},k=w,S=(i("ad4c"),Object(u["a"])(k,a,s,!1,null,"e0a6d82c",null));e["default"]=S.exports},f688:function(t,e,i){"use strict";e["a"]=function(t=null){return{data(){return{data:t,isLoading:!0}},async created(){this.data=await this.feachData(),this.sortData(),this.isLoading=!1},methods:{sortData(){this.data.rows&&this.data.rows.sort((t,e)=>e.createDate-t.createDate)}}}}}}]);
//# sourceMappingURL=chunk-477d9e98.4e306bf8.js.map